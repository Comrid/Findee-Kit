<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.5">
    <title>Findee Robot Control Dashboard</title>
    <!-- ì •ì  CSS íŒŒì¼ ë§í¬ -->
    <link rel="stylesheet" href="../static/css/style.css">
    <!-- Socket.IO í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header
         c:header
            c:status-info
                c:status-item
                    c:status-dot    id:connectionDot
                    id:connectionStatus
                c:status-item
                    id:networkInfo
                c:status-item
                    id:systemInfo
         -->
        <header class="header">
            <h1>ğŸ¤– Findee Robot Dashboard</h1>
            <div class="status-info">
                <div class="status-item">
                    <div class="status-dot" id="connectionDot"></div>
                    <span id="connectionStatus">Connecting...</span>
                </div>
                <div class="status-item">
                    <span id="networkInfo">ğŸ“¶ Network: --</span>
                </div>
                <div class="status-item">
                    <span id="systemInfo">ğŸ”‹ System: --</span>
                </div>
            </div>
        </header>

        <!-- Camera Feed
         c:camera-container
            c:camera-info, id:cameraInfo
            c:camera-feed, id:cameraStream

         -->
        <div class="camera-container">
            <div class="camera-info" id="cameraInfo">ğŸ“¹ Camera: Active</div>
            <img src="/video_feed" alt="Camera Feed" class="camera-feed" id="cameraStream" style="image-rendering: pixelated;"
                 onerror="this.style.display='none'; document.getElementById('cameraError').style.display='flex';">

            <!-- ì¹´ë©”ë¼ ì˜¤ë¥˜ ì‹œ í‘œì‹œí•  ì˜¤ë²„ë ˆì´ -->
            <div id="cameraError" style="display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
                                         background: rgba(0, 0, 0, 0.5); color: white; text-align: center;
                                         display: flex; align-items: center; justify-content: center; flex-direction: column; gap: 15px;">
                <div style="width: 60px; height: 60px; background: rgba(255, 255, 255, 0.2); border-radius: 50%;
                           display: flex; align-items: center; justify-content: center; font-size: 24px;">ğŸ“¹</div>
                <div>Camera Not Available</div>
                <div style="font-size: 12px; opacity: 0.7;">ì¹´ë©”ë¼ ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”</div>
            </div>
        </div>

        <!-- Controls Panel -->
        <div class="controls-panel">
            <h3 class="controls-title">Robot Control</h3>

            <!-- Robot Status -->
            <div class="robot-status" id="robotStatus">
                <div class="status-card">
                    <div class="label">Motor</div>
                    <div class="value" id="motorStatus">--</div>
                </div>
                <div class="status-card">
                    <div class="label">Camera</div>
                    <div class="value" id="cameraStatus">--</div>
                </div>
                <div class="status-card">
                    <div class="label">Ultrasonic</div>
                    <div class="value" id="ultrasonicStatus">--</div>
                </div>
                <div class="status-card">
                    <div class="label">FPS</div>
                    <div class="value" id="fpsStatus">0</div>
                </div>
            </div>

            <!-- Direction Pad -->
            <div class="direction-pad">
                <button class="direction-btn btn-forward-left" data-direction="forward-left" title="ì „ì§„+ì¢ŒíšŒì „">â†–</button>
                <button class="direction-btn btn-forward" data-direction="forward" title="ì „ì§„">â†‘</button>
                <button class="direction-btn btn-forward-right" data-direction="forward-right" title="ì „ì§„+ìš°íšŒì „">â†—</button>

                <button class="direction-btn btn-rotate-left" data-direction="rotate-left" title="ì œìë¦¬ ì¢ŒíšŒì „">â†º</button>
                <button class="direction-btn btn-stop" data-direction="stop" title="ì •ì§€">â¹</button>
                <button class="direction-btn btn-rotate-right" data-direction="rotate-right" title="ì œìë¦¬ ìš°íšŒì „">â†»</button>

                <button class="direction-btn btn-backward-left" data-direction="backward-left" title="í›„ì§„+ì¢ŒíšŒì „">â†™</button>
                <button class="direction-btn btn-backward" data-direction="backward" title="í›„ì§„">â†“</button>
                <button class="direction-btn btn-backward-right" data-direction="backward-right" title="í›„ì§„+ìš°íšŒì „">â†˜</button>
            </div>

            <!-- Speed Control -->
            <div class="speed-control">
                <label class="speed-label">ì†ë„ ì¡°ì ˆ</label>
                <input type="range" class="speed-slider" id="speedSlider" min="20" max="100" value="60">
                <div class="speed-value" id="speedValue">60%</div>
                <div class="speed-range">
                    <span>20%</span>
                    <span>100%</span>
                </div>
            </div>

            <!-- Log Panel -->
            <div class="log-panel">
                <div class="log-header">
                    <h4>Activity Log</h4>
                    <button class="log-clear-btn" id="clearLogBtn">Clear</button>
                </div>
                <div class="log-content" id="logContent">
                    <div class="log-item system">ğŸš€ Findee Robot Dashboard initialized</div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="keyboard-hints">
                <div class="hint-item">
                    <span class="key">â†‘â†“â†â†’</span>
                    <span>ê¸°ë³¸ ì¡°ì‘</span>
                </div>
                <div class="hint-item">
                    <span class="key">Space</span>
                    <span>ì •ì§€</span>
                </div>
                <div class="hint-item">
                    <span class="key">+/-</span>
                    <span>ì†ë„ ì¡°ì ˆ</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- Flask ì •ì  íŒŒì¼ ì„œë¹™ ê¸°ëŠ¥ ì‚¬ìš©  -->
    <script src="{{ url_for('static', filename='js/robot-controller.js') }}"></script>

    <!-- CSS ì •ì  / url_for() íŒŒì¼ ê²½ë¡œ ë³€ê²½ -->
    <script>
        function isFlaskEnvironment() {
            return window.location.protocol === 'http:' || window.location.protocol === 'https:';
        }

        if (isFlaskEnvironment()) {
            // CSS íŒŒì¼ ê²½ë¡œ ë³€ê²½
            const cssLink = document.querySelector('link[href="../static/css/style.css"]');
            if (cssLink) {
                cssLink.href = '/static/css/style.css';
            }
            // ì½˜ì†” ë¡œê·¸
            console.log('ğŸ”§ CSS File Reloaded for Flask');
        }
    </script>
</body>
</html>